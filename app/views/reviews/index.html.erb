<%= javascript_include_tag 'reviews' %>

<div class="pagepad">
  <div id="breadcrumb">
    <ul>
      <li><a href="" class="last">My Reviews</a></li>
    </ul>
  </div>  
  
  <h1>My Reviews</h1>
  
  <div id="contextmenu">
    <ul class="left">
      <li><%= link_to('New Review', new_review_url, :class => 'edit withicon', :remote => true) %></li>
    </ul>
    <div class="clear"></div>
  </div>
  
  <div class="projectedit">
    <div class="left">
      <div id="tabs">
        <ul class="tabs">
          <li><%= link_to("Current Reviews", '#toreview') %></li>
          <li><%= link_to("Past Reviews", '#pastreview') %></li>
        </ul>
    
        <div class="tabcontent" id="toreview">
          <table class="people">
            <thead>
              <tr>
                <th class="expand"></th>
                <th class="gender"></th>
                <th class="name">Name</th>
                <th class="reviewname">Review Name</th>
                <th class="accdate">Due Date</th>
                <th class="status">Status</th>
              </tr>
            </thead>
            <tbody>
              <%- for review in @reviews -%>
              <tr id="review_<%=review.id%>" class="review_title">
                <td class="expand">
                  <%= link_to image_tag("expand.png"), review_url(review), :remote => true, :class => "expand_button" %>
                  <%= link_to_function image_tag("expanded.png"), %|
                  $("tr#review_#{review.id}.reviewer_content").addClass("reviewer_content_hide");
                  $("tr#review_#{review.id}").removeClass("expanded");
                  $("tr#review_#{review.id} .collapse_button").hide();
                  $("tr#review_#{review.id} .expand_button").show();
                  |, :class => "collapse_button", :style => "display:none" %>
                </td>
                <td class="gender"><%= gender_icon(review.subject) %></td>
                <td class="name"><%= person_link_if_authed(review.subject) %></td>
                <td class="reviewname"><%= review.name %></td>
                <td class="duedate"><span class="<%= "alert" if review.late? %>"><%= I18n.l review.due %></span></td>
                <td class="status">0%</td>
              </tr>
              <tr id="review_<%=review.id%>" class="reviewer_content reviewer_content_hide">
                <td colspan="6" class="rowwrap">
                </td>
              </tr>
              <%- end -%>
          </table>
        </div>
        
        <div class="tabcontent" id="pastreview">
          <table class="people">
            <thead>
              <tr>
                <th class="gender"></th>
                <th class="name">Name</th>
                <th class="reviewname">Review Name</th>
                <th class="accdate">Due Date</th>
                <th class="status">Status</th>
              </tr>
            </thead>
            <tbody>
              <!-- TODO -->
            </tbody>
          </table>
        </div>
      </div>
    </div>

    <%= render "people/sidebar", :person => current_person %>

    <div class="clear"></div>
    <div id="new_reviewer_dialog" style="display:none" title="Add reviewers"><span class="ui-icon ui-icon-alert" style="float:left; margin:0 7px 20px 0;"></span><span id="dialog-message"></span></div>
    <div id="new_review_dialog" style="display:none" title="New Review"><span class="ui-icon ui-icon-alert" style="float:left; margin:0 7px 20px 0;"></span><span id="dialog-message"></span></div>
    <%- if @add_dialog -%>
    <script>
    $(document).ready(function() {
      <%= render :file => "reviews/show.js.rjs" %>
      <%= render :file => "reviewers/new.js.rjs" %>
      $("#new_reviewer_prompt").html("The review for <%=@review.subject.full_name%> has been created.  You can now add reviewers.  When finished, hit the Done button.");
    });
    </script>
    <%- end -%>
  </div>
</div>
